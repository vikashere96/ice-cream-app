{% extends 'admin_base.html' %}

{% block content %}
<div class="min-h-screen bg-slate-900 text-white p-6">
    <h1 class="text-3xl font-bold mb-6">ğŸ¦ Ice Cream Shop Dashboard</h1>
    
    <!-- Debug Info -->
    <div class="bg-blue-900/20 border border-blue-500/30 rounded-lg p-4 mb-6">
        <h2 class="text-xl font-semibold mb-3">ğŸ“Š Debug Information</h2>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
            <div>
                <div class="text-blue-300">Today's Orders</div>
                <div class="text-2xl font-bold">{{ stats.total_orders_today }}</div>
            </div>
            <div>
                <div class="text-green-300">Today's Revenue</div>
                <div class="text-2xl font-bold">â‚¹{{ stats.total_revenue_today|floatformat:0 }}</div>
            </div>
            <div>
                <div class="text-purple-300">Popular Item</div>
                <div class="text-lg font-bold">{{ stats.most_popular_ice_cream }}</div>
            </div>
            <div>
                <div class="text-orange-300">Total Orders</div>
                <div class="text-2xl font-bold">{{ orders_by_status.pending.count|add:orders_by_status.in_progress.count|add:orders_by_status.completed.count|add:orders_by_status.cancelled.count }}</div>
            </div>
        </div>
    </div>

    <!-- Orders by Status -->
    <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
        <!-- Pending Orders -->
        <div class="bg-yellow-900/20 border border-yellow-500/30 rounded-lg p-4">
            <h3 class="text-lg font-semibold mb-3 text-yellow-300">
                ğŸŸ¡ Pending ({{ orders_by_status.pending.count }})
            </h3>
            <div class="space-y-2">
                {% for order in orders_by_status.pending|slice:":5" %}
                <div class="bg-yellow-800/20 rounded p-2 text-sm">
                    <div class="font-medium">Order #{{ order.id }}</div>
                    <div class="text-yellow-200">{{ order.customer_name }}</div>
                    <div class="text-yellow-300">â‚¹{{ order.get_total_amount }}</div>
                </div>
                {% empty %}
                <div class="text-yellow-400 text-sm">No pending orders</div>
                {% endfor %}
            </div>
        </div>

        <!-- In Progress Orders -->
        <div class="bg-blue-900/20 border border-blue-500/30 rounded-lg p-4">
            <h3 class="text-lg font-semibold mb-3 text-blue-300">
                ğŸ”µ In Progress ({{ orders_by_status.in_progress.count }})
            </h3>
            <div class="space-y-2">
                {% for order in orders_by_status.in_progress|slice:":5" %}
                <div class="bg-blue-800/20 rounded p-2 text-sm">
                    <div class="font-medium">Order #{{ order.id }}</div>
                    <div class="text-blue-200">{{ order.customer_name }}</div>
                    <div class="text-blue-300">â‚¹{{ order.get_total_amount }}</div>
                </div>
                {% empty %}
                <div class="text-blue-400 text-sm">No orders in progress</div>
                {% endfor %}
            </div>
        </div>

        <!-- Completed Orders -->
        <div class="bg-green-900/20 border border-green-500/30 rounded-lg p-4">
            <h3 class="text-lg font-semibold mb-3 text-green-300">
                ğŸŸ¢ Completed ({{ orders_by_status.completed.count }})
            </h3>
            <div class="space-y-2">
                {% for order in orders_by_status.completed|slice:":5" %}
                <div class="bg-green-800/20 rounded p-2 text-sm">
                    <div class="font-medium">Order #{{ order.id }}</div>
                    <div class="text-green-200">{{ order.customer_name }}</div>
                    <div class="text-green-300">â‚¹{{ order.get_total_amount }}</div>
                </div>
                {% empty %}
                <div class="text-green-400 text-sm">No completed orders</div>
                {% endfor %}
            </div>
        </div>

        <!-- Cancelled Orders -->
        <div class="bg-red-900/20 border border-red-500/30 rounded-lg p-4">
            <h3 class="text-lg font-semibold mb-3 text-red-300">
                ğŸ”´ Cancelled ({{ orders_by_status.cancelled.count }})
            </h3>
            <div class="space-y-2">
                {% for order in orders_by_status.cancelled|slice:":5" %}
                <div class="bg-red-800/20 rounded p-2 text-sm">
                    <div class="font-medium">Order #{{ order.id }}</div>
                    <div class="text-red-200">{{ order.customer_name }}</div>
                    <div class="text-red-300">â‚¹{{ order.get_total_amount }}</div>
                </div>
                {% empty %}
                <div class="text-red-400 text-sm">No cancelled orders</div>
                {% endfor %}
            </div>
        </div>
    </div>

    <!-- Actions -->
    <div class="mt-6 flex space-x-4">
        <button onclick="location.reload()" class="px-4 py-2 bg-blue-600 hover:bg-blue-500 rounded-lg">
            ğŸ”„ Refresh
        </button>
        <button onclick="window.location.href='/panel/dashboard/'" class="px-4 py-2 bg-green-600 hover:bg-green-500 rounded-lg">
            ğŸ“Š Full Dashboard
        </button>
    </div>
</div>

<script>
console.log('Simple dashboard loaded');
console.log('Stats:', {{ stats|safe }});
console.log('Orders by status counts:', {
    pending: {{ orders_by_status.pending.count }},
    in_progress: {{ orders_by_status.in_progress.count }},
    completed: {{ orders_by_status.completed.count }},
    cancelled: {{ orders_by_status.cancelled.count }}
});
</script>
{% endblock %}