<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Placed Successfully</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-950 text-white min-h-screen">
    <div class="max-w-2xl mx-auto px-6 py-10">
        <div class="rounded-2xl bg-white/10 backdrop-blur-md border border-white/20 p-8 text-center">
            <div class="mx-auto mb-6 w-16 h-16 rounded-full bg-emerald-500/20 border border-emerald-500/30 flex items-center justify-center">
                <svg width="36" height="36" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" class="text-emerald-400"><circle cx="12" cy="12" r="10"/><path d="M8 12l2 2l4-4"/></svg>
            </div>
            <h1 class="text-3xl font-bold mb-2">Order Placed!</h1>
            <p class="text-white/70 mb-2">Thank you for your order. Payment received successfully.</p>
            <p class="text-lg font-semibold text-indigo-300 mb-6">Order #<span id="order-number">{{ order_id|default:"12345" }}</span></p>

            <div class="text-left mb-6">
                <h2 class="text-xl font-semibold mb-3">Invoice</h2>
                <div id="invoice-area" class="rounded-xl bg-gray-900 border border-white/10 p-4">
                    <table class="w-full mb-3">
                        <thead>
                            <tr class="border-b border-white/10 text-white/70">
                                <th class="text-left py-1">Item</th>
                                <th class="text-right py-1">Qty</th>
                                <th class="text-right py-1">Price</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for item in items %}
                            <tr class="border-b border-white/5">
                                <td class="py-1">{{ item.ice_cream.name }}</td>
                                <td class="text-right py-1">{{ item.quantity }}</td>
                                <td class="text-right py-1">₹{{ item.ice_cream.price|floatformat:2 }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    <div class="text-right font-bold">Total: ₹{{ total|floatformat:2 }}</div>
                </div>
                <button onclick="downloadInvoicePDF()" class="mt-4 px-4 py-2 rounded-lg bg-indigo-600 hover:bg-indigo-500 transition">Download PDF Invoice</button>
            </div>

            <div class="mt-4 text-sm text-white/70">If you want to cancel the order, please meet the order counter immediately.</div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        function downloadInvoicePDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            const title = `Ice Cream Shop\nOrder #{{ order_id|default:"12345" }}`;
            doc.setFont('helvetica','bold'); doc.setFontSize(16); doc.text(title, 14, 20);
            doc.setFont('helvetica',''); doc.setFontSize(11);
            let y = 30;
            doc.text('Items', 14, y); doc.text('Qty', 120, y, { align:'right' }); doc.text('Price', 200-14, y, { align:'right' }); y += 6;
            doc.line(14, y, 200-14, y); y += 6;
            {% for item in items %}
                doc.text('{{ item.ice_cream.name|escapejs }}', 14, y);
                doc.text('{{ item.quantity }}', 120, y, { align:'right' });
                doc.text('₹{{ item.ice_cream.price|floatformat:2 }}', 200-14, y, { align:'right' }); y += 6;
            {% endfor %}
            y += 6; doc.setFont('helvetica','bold');
            doc.text('Total: ₹{{ total|floatformat:2 }}', 200-14, y, { align:'right' });
            doc.save('invoice_order_{{ order_id|default:"12345" }}.pdf');
        }
    </script>
</body>
</html>